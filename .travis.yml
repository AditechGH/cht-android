language: android
dist: trusty
jdk: oraclejdk8
android:
  components:
  - tools
  - platform-tools
  - extra-android-m2repository
  - build-tools-28.0.2
  - android-26
env:
- GRADLE_OPTS="-XX:MaxPermSize=512m"
script:
- make travis
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
  - "$HOME/.android/build-cache"
deploy:
  provider: releases
  skip_cleanup: true
  overwrite: true
  api_key:
    secure: dxizbwuX5L1DOVdH2pU42MxienBbfZsJ1r6yfaZHvL/fKaXhwhtdXXYdwAz3U/DdGYZD3q8z0WM6QAoPcssSpYgukFxhbMuwaR7lFeR6Ya+w0lsptO1W+chgKXATjGeTWaAOXTE8Wcg8woxeJGaTznJEQnpurchlRAl3a07vUrKXB/tkiyNMWz1VoZPdAXZqgyQHfIALIJuXbcJQQ4KR5ETL2ldNk1m0xnwinrm/B88aQbW7NWtVmPPwWRnNn1t0OBXznqDln3y7sFIdmMHnFg5q0ZW/X7aZC2Wb4tf+wceRxVhuCTQeD6fQ0AB6vUaLiD6aEdAxq7hdbav/SvFBz6taiUcWmznIZp0LoyYa4RFN4IcNNTQ9FHcQqrO54J+VycdrOiP09FPJC13TBoG/TbKGLFdBXAJcpCAF18EYW6f8yuhFixmHBfUmq5iUXDzXbaWco7CSnH2KpIhwuHF/7jI9jbVfoxLKDWAn0E4s1IA6LykDkZeQ0cWBR1+H+cOwr2OsDMhtGwYQxICJj0BrskJVarT2WdtcuUqkGY4in0jzcG8UCSMCLGJRMhBUWe/fVPCktgGxWq6vXK6k5v0PLOKh2cdt4+W4Zr3kT0Lb5nItXukfAQNMGbYjdI+UtqVOJKxxeJaYIlDYHmSe/fit0y7U1kuiuEbfZXeKihsLbmo=
  file_glob: true
  file: build/outputs/apk/release/*
  on:
    #tags: true
    repo: medic/medic-android
    branch: 3186-travis-build
before_install:
- openssl aes-256-cbc -K $encrypted_323c4a109760_key -iv $encrypted_323c4a109760_iv
  -in medic-official.keystore.enc -out medic-official.keystore -d
